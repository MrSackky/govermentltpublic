{"ast":null,"code":"var _jsxFileName = \"D:\\\\govermentlt\\\\components\\\\managemnet\\\\cover-menu\\\\add-menu.jsx\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport { InboxOutlined } from '@ant-design/icons';\nimport { Button, Form, Image, Input, Modal, notification, Select, Typography, Upload, Switch } from 'antd';\nimport axios from 'axios';\nimport dynamic from 'next/dynamic';\nimport React, { useRef, useState } from 'react';\nimport { apiInstance } from '../../../middleware/utils';\nconst {\n  Option\n} = Select;\nconst {\n  TextArea\n} = Input; // const config = require('./../../config');\n\nconst config = require('../../../pages/admin/config');\n\nconst JoditEditor = dynamic(() => import('jodit-react'), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('jodit-react')],\n    modules: ['jodit-react']\n  }\n});\nconst {\n  Text,\n  Title\n} = Typography;\nexport default function modal({\n  fetch,\n  user,\n  pollId\n}) {\n  let divRef = useRef(null);\n  const [api, contextHolder] = notification.useNotification();\n  const {\n    0: visible,\n    1: setVisible\n  } = useState(false);\n  const [form] = Form.useForm();\n  const {\n    0: previewImage,\n    1: setPreviewImage\n  } = useState(null);\n  const {\n    0: imageLandingPage,\n    1: setImageLandingPage\n  } = useState(null);\n  const {\n    0: previewVisible,\n    1: setPreviewVisible\n  } = useState(false);\n\n  const onSubmitHandler = async value => {\n    const data = {\n      organization_id: user.organization_id,\n      header_image: imageLandingPage,\n      header_link: value.header_link\n    };\n    const registerData = await apiInstance().post('/covermenu', data);\n\n    if (registerData.data.status == 200) {\n      openNotificationSuccess();\n    } else {\n      openNotificationFail(registerData.data.message);\n    }\n\n    setVisible(false);\n    fetch();\n    onReset();\n  };\n\n  const openNotificationSuccess = () => {\n    api.success({\n      message: `บันทึกมูลสำเร็จ`,\n      description: 'บันทึกมูลสำเร็จ',\n      placement: 'topRight'\n    });\n  };\n\n  const openNotificationFail = messgae => {\n    api.error({\n      message: `พบปัญหาระหว่างการบันทึกข้อมูล`,\n      description: messgae,\n      placement: 'topRight'\n    });\n  };\n\n  const {\n    Dragger\n  } = Upload;\n\n  const onReset = () => {\n    resetImagePreview();\n    form.resetFields();\n  };\n\n  const imageUploadprops = {\n    name: 'file',\n    multiple: false,\n    listType: 'text',\n    maxCount: 1,\n    action: \"/api/upload/cover\",\n    preview: false,\n    // uid: user.type_user == 1 ? \"admin\" : user.organization_id,\n    // beforeUpload(file) {\n    // \tconst isLt10M = file.size / 1024 / 1024 < 10\n    // \tif (!isLt10M) {\n    // \t\tnotification.open({\n    // \t\t\tmessage: 'Upload error!',\n    // \t\t\tdescription: <Text className=\"text-black\">Image must smaller than 10MB!</Text>,\n    // \t\t})\n    // \t}\n    // \treturn isLt10M\n    // },\n    customRequest: options => {\n      const data = new FormData();\n      data.append('file', options.file);\n      data.append('id', user.type_user == 1 ? \"admin\" : user.organization_id);\n      const config = {\n        \"headers\": {\n          \"content-type\": 'multipart/form-data; boundary=----WebKitFormBoundaryqTqJIxvkWFYqvP5s'\n        }\n      };\n      axios.post(options.action, data, config).then(res => {\n        // imageLandingPage\n        // console.log(res.data.data.list[0]._name)\n        setImageLandingPage(res.data.data.list[0]._name);\n        options.onSuccess(res.data, options.file);\n      }).catch(err => {\n        console.log(err);\n      });\n    },\n\n    async onChange(info) {\n      const {\n        status\n      } = info.file; // console.log(user)\n\n      switch (info.file.status) {\n        // case \"uploading\":\n        //   nextState.selectedFileList = [info.file];\n        //   break;\n        case \"done\":\n          if (!info.file.url && !info.file.preview) {\n            info.file.preview = await getBase64(info.file.originFileObj);\n          }\n\n          setPreviewImage(info.file.url || info.file.preview);\n          setPreviewVisible(true);\n          break;\n\n        default:\n          // error or removed\n          resetImagePreview();\n      } //console.log(info.file)\n      // this.setState({\n      //   previewImage: file.url || file.preview,\n      //   previewVisible: true,\n      // });\n\n    },\n\n    onRemove(info) {\n      resetImagePreview();\n    }\n\n  };\n\n  const resetImagePreview = () => {\n    setPreviewVisible(false);\n    setPreviewImage(null);\n  };\n\n  function getBase64(file) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onload = () => resolve(reader.result);\n\n      reader.onerror = error => reject(error);\n    });\n  }\n\n  return __jsx(React.Fragment, null, __jsx(\"a\", {\n    onClick: () => setVisible(true),\n    className: \"ml-4 lg:inline-flex lg:w-auto w-full px-2 py-2 rounded h-8 text-white bg-green-600 font-bold items-center justify-center hover:bg-green-600 hover:text-white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 7\n    }\n  }, \"\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E2B\\u0E31\\u0E27\\u0E40\\u0E27\\u0E47\\u0E1A\\u0E44\\u0E0B\\u0E15\\u0E4C\"), contextHolder, __jsx(Modal, {\n    title: \"\\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E2B\\u0E31\\u0E27\\u0E40\\u0E27\\u0E47\\u0E1A\\u0E44\\u0E0B\\u0E15\\u0E4C\",\n    className: \"mt-4\",\n    centered: true,\n    visible: visible // onOk={() => onOK()}\n    ,\n    onCancel: () => {\n      // form.resetFields();\n      setVisible(false);\n    },\n    width: 1000,\n    footer: null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }\n  }, __jsx(Form, {\n    name: \"basic\",\n    layout: \"vertical\",\n    onFinish: onSubmitHandler,\n    requiredMark: true,\n    form: form,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 9\n    }\n  }, __jsx(Form.Item, {\n    name: \"##\",\n    label: \"\\u0E20\\u0E32\\u0E1E\\u0E2A\\u0E48\\u0E27\\u0E19\\u0E2B\\u0E31\\u0E27\\u0E40\\u0E27\\u0E47\\u0E1A\\u0E44\\u0E0B\\u0E15\\u0E4C : \",\n    className: \"block text-gray-700 text-sm font-bold mb-2 w-full\",\n    rules: [{\n      required: true,\n      message: 'กรุณากรอกเลือกภาพส่วนหัวเว็บไซต์'\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 10\n    }\n  }, __jsx(Dragger, _extends({\n    maxCount: 1 // listType=\"picture\"\n    ,\n    accept: \".jpg, .jpeg, .png\"\n  }, imageUploadprops, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 13\n    }\n  }), previewVisible && __jsx(React.Fragment, null, __jsx(Image // width={200}\n  , {\n    preview: false,\n    src: previewImage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 36\n    }\n  })), !previewVisible && __jsx(React.Fragment, null, __jsx(\"p\", {\n    className: \"ant-upload-drag-icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 17\n    }\n  }, __jsx(InboxOutlined, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 19\n    }\n  })), __jsx(\"p\", {\n    className: \"ant-upload-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 17\n    }\n  }, \"\\u0E04\\u0E25\\u0E34\\u0E01 \\u0E2B\\u0E23\\u0E37\\u0E2D \\u0E25\\u0E32\\u0E01\\u0E44\\u0E1F\\u0E25\\u0E4C\\u0E21\\u0E32\\u0E17\\u0E35\\u0E48\\u0E1A\\u0E23\\u0E34\\u0E40\\u0E27\\u0E13\\u0E19\\u0E35\\u0E49\\u0E40\\u0E1E\\u0E37\\u0E48\\u0E2D\\u0E2D\\u0E31\\u0E1B\\u0E42\\u0E2B\\u0E25\\u0E14\")))), __jsx(Form.Item, {\n    name: \"header_link\",\n    label: \"\\u0E25\\u0E34\\u0E07\\u0E04\\u0E4C\",\n    style: {\n      float: 'left'\n    },\n    className: \"block text-gray-700 text-sm font-bold mb-2 w-full\" // rules={[\n    //   {\n    //     required: true,\n    //     message: 'กรุณากรอกลิงค์ URL',\n    //   },\n    // ]}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 11\n    }\n  }, __jsx(Input, {\n    id: \"#\",\n    type: \"text\",\n    placeholder: \"\\u0E25\\u0E34\\u0E07\\u0E04\\u0E4C\",\n    className: \"resize-none border rounded-md\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 13\n    }\n  })), __jsx(Form.Item, {\n    className: \" text-gray-700 text-sm font-bold mb-2 w-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: \"lg:inline-flex text-left w-1/2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 13\n    }\n  }, __jsx(Switch, {\n    className: \"swt-btn\",\n    checked: active,\n    onClick: value => setActive(value ? 1 : 0),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 15\n    }\n  }), __jsx(\"p\", {\n    className: \"mx-2 text-sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 15\n    }\n  }, \"\\u0E01\\u0E32\\u0E23\\u0E41\\u0E2A\\u0E14\\u0E07\\u0E1C\\u0E25\")), __jsx(\"div\", {\n    className: \"lg:inline-flex w-full mt-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"text-center lg:text-right w-full lg:w-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 15\n    }\n  }, __jsx(Button, {\n    htmlType: \"button\",\n    onClick: onReset,\n    style: {\n      backgroundColor: '#C2CFE0',\n      borderColor: '#C2CFE0',\n      height: 40,\n      width: 110,\n      marginBottom: '0px !important',\n      marginRight: '2px',\n      color: 'white !important'\n    } // htmlType=\"submit\"\n    ,\n    className: \"text-center bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full lg:w-1/4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 17\n    }\n  }, __jsx(Text, {\n    className: \"text-custom-black \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 19\n    }\n  }, \"\\u0E23\\u0E35\\u0E40\\u0E0B\\u0E47\\u0E17\")), __jsx(Button // type=\"primary\"\n  , {\n    style: {\n      backgroundColor: '#059669',\n      borderColor: '#059669',\n      height: 40,\n      width: 110,\n      marginBottom: '0px !important',\n      color: 'white !important'\n    },\n    htmlType: \"submit\",\n    className: \"text-center bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full lg:w-1/4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 17\n    }\n  }, __jsx(Text, {\n    className: \"text-custom-white \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 19\n    }\n  }, \"\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\")))))), __jsx(\"div\", {\n    style: {\n      float: 'left',\n      clear: 'both'\n    },\n    ref: divRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 9\n    }\n  })));\n}","map":{"version":3,"sources":["D:/govermentlt/components/managemnet/cover-menu/add-menu.jsx"],"names":["InboxOutlined","Button","Form","Image","Input","Modal","notification","Select","Typography","Upload","Switch","axios","dynamic","React","useRef","useState","apiInstance","Option","TextArea","config","require","JoditEditor","ssr","Text","Title","modal","fetch","user","pollId","divRef","api","contextHolder","useNotification","visible","setVisible","form","useForm","previewImage","setPreviewImage","imageLandingPage","setImageLandingPage","previewVisible","setPreviewVisible","onSubmitHandler","value","data","organization_id","header_image","header_link","registerData","post","status","openNotificationSuccess","openNotificationFail","message","onReset","success","description","placement","messgae","error","Dragger","resetImagePreview","resetFields","imageUploadprops","name","multiple","listType","maxCount","action","preview","customRequest","options","FormData","append","file","type_user","then","res","list","_name","onSuccess","catch","err","console","log","onChange","info","url","getBase64","originFileObj","onRemove","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","required","float","active","setActive","backgroundColor","borderColor","height","width","marginBottom","marginRight","color","clear"],"mappings":";;;;;AAAA,SAASA,aAAT,QAA8B,mBAA9B;AACA,SACEC,MADF,EAEEC,IAFF,EAEQC,KAFR,EAEeC,KAFf,EAGEC,KAHF,EAIEC,YAJF,EAKEC,MALF,EAMEC,UANF,EAOEC,MAPF,EAOUC,MAPV,QAQO,MARP;AASA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,OAAP,MAAoB,cAApB;AACA,OAAOC,KAAP,IAAgBC,MAAhB,EAAwBC,QAAxB,QAAwC,OAAxC;AACA,SAASC,WAAT,QAA4B,2BAA5B;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAaV,MAAnB;AACA,MAAM;AAAEW,EAAAA;AAAF,IAAed,KAArB,C,CACA;;AACA,MAAMe,MAAM,GAAGC,OAAO,CAAC,6BAAD,CAAtB;;AACA,MAAMC,WAAW,GAAGT,OAAO,CAAC,MAAM,OAAO,aAAP,CAAP,EAA8B;AAAEU,EAAAA,GAAG,EAAE,KAAP;AAAA;AAAA,wCAAhB,aAAgB;AAAA,cAAhB,aAAgB;AAAA;AAAA,CAA9B,CAA3B;AACA,MAAM;AAAEC,EAAAA,IAAF;AAAQC,EAAAA;AAAR,IAAkBhB,UAAxB;AACA,eAAe,SAASiB,KAAT,CAAe;AAAEC,EAAAA,KAAF;AAASC,EAAAA,IAAT;AAAeC,EAAAA;AAAf,CAAf,EAAwC;AACrD,MAAIC,MAAM,GAAGf,MAAM,CAAC,IAAD,CAAnB;AACA,QAAM,CAACgB,GAAD,EAAMC,aAAN,IAAuBzB,YAAY,CAAC0B,eAAb,EAA7B;AACA,QAAM;AAAA,OAACC,OAAD;AAAA,OAAUC;AAAV,MAAwBnB,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAACoB,IAAD,IAASjC,IAAI,CAACkC,OAAL,EAAf;AACA,QAAM;AAAA,OAACC,YAAD;AAAA,OAAeC;AAAf,MAAkCvB,QAAQ,CAAC,IAAD,CAAhD;AACA,QAAM;AAAA,OAACwB,gBAAD;AAAA,OAAmBC;AAAnB,MAA0CzB,QAAQ,CAAC,IAAD,CAAxD;AACA,QAAM;AAAA,OAAC0B,cAAD;AAAA,OAAiBC;AAAjB,MAAsC3B,QAAQ,CAAC,KAAD,CAApD;;AAEA,QAAM4B,eAAe,GAAG,MAAMC,KAAN,IAAe;AACrC,UAAMC,IAAI,GAAG;AACXC,MAAAA,eAAe,EAAEnB,IAAI,CAACmB,eADX;AAEXC,MAAAA,YAAY,EAAER,gBAFH;AAGXS,MAAAA,WAAW,EAAEJ,KAAK,CAACI;AAHR,KAAb;AAKA,UAAMC,YAAY,GAAG,MAAMjC,WAAW,GAAGkC,IAAd,CAAmB,YAAnB,EAAiCL,IAAjC,CAA3B;;AACA,QAAII,YAAY,CAACJ,IAAb,CAAkBM,MAAlB,IAA4B,GAAhC,EAAqC;AACnCC,MAAAA,uBAAuB;AACxB,KAFD,MAEO;AACLC,MAAAA,oBAAoB,CAACJ,YAAY,CAACJ,IAAb,CAAkBS,OAAnB,CAApB;AACD;;AACDpB,IAAAA,UAAU,CAAC,KAAD,CAAV;AACAR,IAAAA,KAAK;AACL6B,IAAAA,OAAO;AACR,GAfD;;AAiBA,QAAMH,uBAAuB,GAAG,MAAM;AACpCtB,IAAAA,GAAG,CAAC0B,OAAJ,CAAY;AACVF,MAAAA,OAAO,EAAG,iBADA;AAEVG,MAAAA,WAAW,EAAE,iBAFH;AAGVC,MAAAA,SAAS,EAAE;AAHD,KAAZ;AAKD,GAND;;AAQA,QAAML,oBAAoB,GAAGM,OAAO,IAAI;AACtC7B,IAAAA,GAAG,CAAC8B,KAAJ,CAAU;AACRN,MAAAA,OAAO,EAAG,+BADF;AAERG,MAAAA,WAAW,EAAEE,OAFL;AAGRD,MAAAA,SAAS,EAAE;AAHH,KAAV;AAKD,GAND;;AAQA,QAAM;AAAEG,IAAAA;AAAF,MAAcpD,MAApB;;AAEA,QAAM8C,OAAO,GAAG,MAAM;AACpBO,IAAAA,iBAAiB;AACjB3B,IAAAA,IAAI,CAAC4B,WAAL;AACD,GAHD;;AAKA,QAAMC,gBAAgB,GAAG;AACvBC,IAAAA,IAAI,EAAE,MADiB;AAEvBC,IAAAA,QAAQ,EAAE,KAFa;AAGvBC,IAAAA,QAAQ,EAAE,MAHa;AAIvBC,IAAAA,QAAQ,EAAE,CAJa;AAKvBC,IAAAA,MAAM,EAAE,mBALe;AAMvBC,IAAAA,OAAO,EAAE,KANc;AAOvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,IAAAA,aAAa,EAAGC,OAAD,IAAa;AAC1B,YAAM3B,IAAI,GAAG,IAAI4B,QAAJ,EAAb;AACA5B,MAAAA,IAAI,CAAC6B,MAAL,CAAY,MAAZ,EAAoBF,OAAO,CAACG,IAA5B;AACA9B,MAAAA,IAAI,CAAC6B,MAAL,CAAY,IAAZ,EAAkB/C,IAAI,CAACiD,SAAL,IAAkB,CAAlB,GAAsB,OAAtB,GAAgCjD,IAAI,CAACmB,eAAvD;AACA,YAAM3B,MAAM,GAAG;AACb,mBAAW;AACT,0BAAgB;AADP;AADE,OAAf;AAKAR,MAAAA,KAAK,CAACuC,IAAN,CAAWsB,OAAO,CAACH,MAAnB,EAA2BxB,IAA3B,EAAiC1B,MAAjC,EAAyC0D,IAAzC,CAA+CC,GAAD,IAAS;AACrD;AACA;AACAtC,QAAAA,mBAAmB,CAACsC,GAAG,CAACjC,IAAJ,CAASA,IAAT,CAAckC,IAAd,CAAmB,CAAnB,EAAsBC,KAAvB,CAAnB;AACAR,QAAAA,OAAO,CAACS,SAAR,CAAkBH,GAAG,CAACjC,IAAtB,EAA4B2B,OAAO,CAACG,IAApC;AACD,OALD,EAKGO,KALH,CAKUC,GAAD,IAAS;AAChBC,QAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACD,OAPD;AASD,KApCsB;;AAqCvB,UAAMG,QAAN,CAAeC,IAAf,EAAqB;AACnB,YAAM;AAAEpC,QAAAA;AAAF,UAAaoC,IAAI,CAACZ,IAAxB,CADmB,CAEnB;;AACA,cAAQY,IAAI,CAACZ,IAAL,CAAUxB,MAAlB;AACE;AACA;AACA;AACA,aAAK,MAAL;AACE,cAAI,CAACoC,IAAI,CAACZ,IAAL,CAAUa,GAAX,IAAkB,CAACD,IAAI,CAACZ,IAAL,CAAUL,OAAjC,EAA0C;AACxCiB,YAAAA,IAAI,CAACZ,IAAL,CAAUL,OAAV,GAAoB,MAAMmB,SAAS,CAACF,IAAI,CAACZ,IAAL,CAAUe,aAAX,CAAnC;AACD;;AACDpD,UAAAA,eAAe,CAACiD,IAAI,CAACZ,IAAL,CAAUa,GAAV,IAAiBD,IAAI,CAACZ,IAAL,CAAUL,OAA5B,CAAf;AACA5B,UAAAA,iBAAiB,CAAC,IAAD,CAAjB;AACA;;AAEF;AACE;AACAoB,UAAAA,iBAAiB;AAdrB,OAHmB,CAmBnB;AAEA;AACA;AACA;AACA;;AAED,KA/DsB;;AAgEvB6B,IAAAA,QAAQ,CAACJ,IAAD,EAAO;AAEbzB,MAAAA,iBAAiB;AAElB;;AApEsB,GAAzB;;AAuEA,QAAMA,iBAAiB,GAAG,MAAM;AAC9BpB,IAAAA,iBAAiB,CAAC,KAAD,CAAjB;AACAJ,IAAAA,eAAe,CAAC,IAAD,CAAf;AACD,GAHD;;AAKA,WAASmD,SAAT,CAAmBd,IAAnB,EAAyB;AACvB,WAAO,IAAIiB,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,YAAMC,MAAM,GAAG,IAAIC,UAAJ,EAAf;AACAD,MAAAA,MAAM,CAACE,aAAP,CAAqBtB,IAArB;;AACAoB,MAAAA,MAAM,CAACG,MAAP,GAAgB,MAAML,OAAO,CAACE,MAAM,CAACI,MAAR,CAA7B;;AACAJ,MAAAA,MAAM,CAACK,OAAP,GAAiBxC,KAAK,IAAIkC,MAAM,CAAClC,KAAD,CAAhC;AACD,KALM,CAAP;AAMD;;AAED,SACE,4BACE;AACE,IAAA,OAAO,EAAE,MAAM1B,UAAU,CAAC,IAAD,CAD3B;AAEE,IAAA,SAAS,EAAC,8JAFZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wGADF,EAOGH,aAPH,EAQE,MAAC,KAAD;AACE,IAAA,KAAK,EAAC,kGADR;AAEE,IAAA,SAAS,EAAC,MAFZ;AAGE,IAAA,QAAQ,MAHV;AAIE,IAAA,OAAO,EAAEE,OAJX,CAKE;AALF;AAME,IAAA,QAAQ,EAAE,MAAM;AACd;AACAC,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KATH;AAUE,IAAA,KAAK,EAAE,IAVT;AAWE,IAAA,MAAM,EAAE,IAXV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAaE,MAAC,IAAD;AACE,IAAA,IAAI,EAAC,OADP;AAEE,IAAA,MAAM,EAAC,UAFT;AAGE,IAAA,QAAQ,EAAES,eAHZ;AAIE,IAAA,YAAY,EAAE,IAJhB;AAKE,IAAA,IAAI,EAAER,IALR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAMC,MAAC,IAAD,CAAM,IAAN;AACC,IAAA,IAAI,EAAC,IADN;AAEC,IAAA,KAAK,EAAC,iHAFP;AAGC,IAAA,SAAS,EAAC,mDAHX;AAIC,IAAA,KAAK,EAAE,CACL;AACEkE,MAAAA,QAAQ,EAAE,IADZ;AAEE/C,MAAAA,OAAO,EAAE;AAFX,KADK,CAJR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAYG,MAAC,OAAD;AACE,IAAA,QAAQ,EAAE,CADZ,CAEE;AAFF;AAGE,IAAA,MAAM,EAAC;AAHT,KAIMU,gBAJN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAOGvB,cAAc,IAAI,4BAAE,MAAC,KAAD,CACnB;AADmB;AAEnB,IAAA,OAAO,EAAE,KAFU;AAGnB,IAAA,GAAG,EAAEJ,YAHc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAF,CAPrB,EAcG,CAACI,cAAD,IAAmB,4BAClB;AAAG,IAAA,SAAS,EAAC,sBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADkB,EAIlB;AAAG,IAAA,SAAS,EAAC,iBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gQAJkB,CAdtB,CAZH,CAND,EA2CE,MAAC,IAAD,CAAM,IAAN;AACE,IAAA,IAAI,EAAC,aADP;AAEE,IAAA,KAAK,EAAC,gCAFR;AAGE,IAAA,KAAK,EAAE;AAAE6D,MAAAA,KAAK,EAAE;AAAT,KAHT;AAIE,IAAA,SAAS,EAAC,mDAJZ,CAKA;AACA;AACA;AACA;AACA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAYE,MAAC,KAAD;AACE,IAAA,EAAE,EAAC,GADL;AAEE,IAAA,IAAI,EAAC,MAFP;AAGE,IAAA,WAAW,EAAC,gCAHd;AAIE,IAAA,SAAS,EAAC,+BAJZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAZF,CA3CF,EA8DE,MAAC,IAAD,CAAM,IAAN;AACE,IAAA,SAAS,EAAC,8CADZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAGE;AAAK,IAAA,SAAS,EAAC,gCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,MAAD;AACE,IAAA,SAAS,EAAC,SADZ;AAEE,IAAA,OAAO,EAAEC,MAFX;AAGE,IAAA,OAAO,EAAE3D,KAAK,IAAI4D,SAAS,CAAC5D,KAAK,GAAG,CAAH,GAAO,CAAb,CAH7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAME;AAAG,IAAA,SAAS,EAAC,cAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8DANF,CAHF,EAYE;AAAK,IAAA,SAAS,EAAC,4BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAC,4CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,MAAD;AACE,IAAA,QAAQ,EAAC,QADX;AAEE,IAAA,OAAO,EAAEW,OAFX;AAGE,IAAA,KAAK,EAAE;AACLkD,MAAAA,eAAe,EAAE,SADZ;AAELC,MAAAA,WAAW,EAAE,SAFR;AAGLC,MAAAA,MAAM,EAAE,EAHH;AAILC,MAAAA,KAAK,EAAE,GAJF;AAKLC,MAAAA,YAAY,EAAE,gBALT;AAMLC,MAAAA,WAAW,EAAE,KANR;AAOLC,MAAAA,KAAK,EAAE;AAPF,KAHT,CAYE;AAZF;AAaE,IAAA,SAAS,EAAC,4IAbZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAeE,MAAC,IAAD;AAAM,IAAA,SAAS,EAAC,oBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CAfF,CADF,EAkBE,MAAC,MAAD,CACE;AADF;AAEE,IAAA,KAAK,EAAE;AACLN,MAAAA,eAAe,EAAE,SADZ;AAELC,MAAAA,WAAW,EAAE,SAFR;AAGLC,MAAAA,MAAM,EAAE,EAHH;AAILC,MAAAA,KAAK,EAAE,GAJF;AAKLC,MAAAA,YAAY,EAAE,gBALT;AAMLE,MAAAA,KAAK,EAAE;AANF,KAFT;AAUE,IAAA,QAAQ,EAAC,QAVX;AAWE,IAAA,SAAS,EAAC,4IAXZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAaE,MAAC,IAAD;AAAM,IAAA,SAAS,EAAC,oBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CAbF,CAlBF,CADF,CAZF,CA9DF,CAbF,EA6HE;AAAK,IAAA,KAAK,EAAE;AAAET,MAAAA,KAAK,EAAE,MAAT;AAAiBU,MAAAA,KAAK,EAAE;AAAxB,KAAZ;AAA8C,IAAA,GAAG,EAAEnF,MAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA7HF,CARF,CADF;AA0ID","sourcesContent":["import { InboxOutlined } from '@ant-design/icons';\r\nimport {\r\n  Button,\r\n  Form, Image, Input,\r\n  Modal,\r\n  notification,\r\n  Select,\r\n  Typography,\r\n  Upload, Switch\r\n} from 'antd';\r\nimport axios from 'axios';\r\nimport dynamic from 'next/dynamic';\r\nimport React, { useRef, useState } from 'react';\r\nimport { apiInstance } from '../../../middleware/utils';\r\nconst { Option } = Select;\r\nconst { TextArea } = Input;\r\n// const config = require('./../../config');\r\nconst config = require('../../../pages/admin/config');\r\nconst JoditEditor = dynamic(() => import('jodit-react'), { ssr: false });\r\nconst { Text, Title } = Typography;\r\nexport default function modal({ fetch, user, pollId }) {\r\n  let divRef = useRef(null);\r\n  const [api, contextHolder] = notification.useNotification();\r\n  const [visible, setVisible] = useState(false);\r\n  const [form] = Form.useForm();\r\n  const [previewImage, setPreviewImage] = useState(null)\r\n  const [imageLandingPage, setImageLandingPage] = useState(null)\r\n  const [previewVisible, setPreviewVisible] = useState(false)\r\n\r\n  const onSubmitHandler = async value => {\r\n    const data = {\r\n      organization_id: user.organization_id,\r\n      header_image: imageLandingPage,\r\n      header_link: value.header_link,\r\n    };\r\n    const registerData = await apiInstance().post('/covermenu', data);\r\n    if (registerData.data.status == 200) {\r\n      openNotificationSuccess();\r\n    } else {\r\n      openNotificationFail(registerData.data.message);\r\n    }\r\n    setVisible(false);\r\n    fetch();\r\n    onReset();\r\n  };\r\n\r\n  const openNotificationSuccess = () => {\r\n    api.success({\r\n      message: `บันทึกมูลสำเร็จ`,\r\n      description: 'บันทึกมูลสำเร็จ',\r\n      placement: 'topRight',\r\n    });\r\n  };\r\n\r\n  const openNotificationFail = messgae => {\r\n    api.error({\r\n      message: `พบปัญหาระหว่างการบันทึกข้อมูล`,\r\n      description: messgae,\r\n      placement: 'topRight',\r\n    });\r\n  };\r\n\r\n  const { Dragger } = Upload;\r\n\r\n  const onReset = () => {\r\n    resetImagePreview()\r\n    form.resetFields();\r\n  };\r\n\r\n  const imageUploadprops = {\r\n    name: 'file',\r\n    multiple: false,\r\n    listType: 'text',\r\n    maxCount: 1,\r\n    action: \"/api/upload/cover\",\r\n    preview: false,\r\n    // uid: user.type_user == 1 ? \"admin\" : user.organization_id,\r\n    // beforeUpload(file) {\r\n    // \tconst isLt10M = file.size / 1024 / 1024 < 10\r\n    // \tif (!isLt10M) {\r\n    // \t\tnotification.open({\r\n    // \t\t\tmessage: 'Upload error!',\r\n    // \t\t\tdescription: <Text className=\"text-black\">Image must smaller than 10MB!</Text>,\r\n    // \t\t})\r\n    // \t}\r\n    // \treturn isLt10M\r\n    // },\r\n    customRequest: (options) => {\r\n      const data = new FormData()\r\n      data.append('file', options.file)\r\n      data.append('id', user.type_user == 1 ? \"admin\" : user.organization_id)\r\n      const config = {\r\n        \"headers\": {\r\n          \"content-type\": 'multipart/form-data; boundary=----WebKitFormBoundaryqTqJIxvkWFYqvP5s'\r\n        }\r\n      }\r\n      axios.post(options.action, data, config).then((res) => {\r\n        // imageLandingPage\r\n        // console.log(res.data.data.list[0]._name)\r\n        setImageLandingPage(res.data.data.list[0]._name)\r\n        options.onSuccess(res.data, options.file)\r\n      }).catch((err) => {\r\n        console.log(err)\r\n      })\r\n\r\n    },\r\n    async onChange(info) {\r\n      const { status } = info.file\r\n      // console.log(user)\r\n      switch (info.file.status) {\r\n        // case \"uploading\":\r\n        //   nextState.selectedFileList = [info.file];\r\n        //   break;\r\n        case \"done\":\r\n          if (!info.file.url && !info.file.preview) {\r\n            info.file.preview = await getBase64(info.file.originFileObj);\r\n          }\r\n          setPreviewImage(info.file.url || info.file.preview)\r\n          setPreviewVisible(true)\r\n          break;\r\n\r\n        default:\r\n          // error or removed\r\n          resetImagePreview()\r\n      }\r\n      //console.log(info.file)\r\n\r\n      // this.setState({\r\n      //   previewImage: file.url || file.preview,\r\n      //   previewVisible: true,\r\n      // });\r\n\r\n    },\r\n    onRemove(info) {\r\n\r\n      resetImagePreview()\r\n\r\n    }\r\n  }\r\n\r\n  const resetImagePreview = () => {\r\n    setPreviewVisible(false)\r\n    setPreviewImage(null)\r\n  }\r\n\r\n  function getBase64(file) {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.readAsDataURL(file);\r\n      reader.onload = () => resolve(reader.result);\r\n      reader.onerror = error => reject(error);\r\n    });\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <a\r\n        onClick={() => setVisible(true)}\r\n        className=\"ml-4 lg:inline-flex lg:w-auto w-full px-2 py-2 rounded h-8 text-white bg-green-600 font-bold items-center justify-center hover:bg-green-600 hover:text-white\"\r\n      >\r\n        เพิ่มหัวเว็บไซต์\r\n      </a>\r\n      {contextHolder}\r\n      <Modal\r\n        title=\"เพิ่มหัวเว็บไซต์\"\r\n        className=\"mt-4\"\r\n        centered\r\n        visible={visible}\r\n        // onOk={() => onOK()}\r\n        onCancel={() => {\r\n          // form.resetFields();\r\n          setVisible(false);\r\n        }}\r\n        width={1000}\r\n        footer={null}\r\n      >\r\n        <Form\r\n          name=\"basic\"\r\n          layout=\"vertical\"\r\n          onFinish={onSubmitHandler}\r\n          requiredMark={true}\r\n          form={form}\r\n        ><Form.Item\r\n          name=\"##\"\r\n          label=\"ภาพส่วนหัวเว็บไซต์ : \"\r\n          className=\"block text-gray-700 text-sm font-bold mb-2 w-full\"\r\n          rules={[\r\n            {\r\n              required: true,\r\n              message: 'กรุณากรอกเลือกภาพส่วนหัวเว็บไซต์',\r\n            },\r\n          ]}\r\n        >\r\n            {/* <Dragger {...dropimg}> */}\r\n            <Dragger\r\n              maxCount={1}\r\n              // listType=\"picture\"\r\n              accept=\".jpg, .jpeg, .png\"\r\n              {...imageUploadprops}\r\n            >\r\n\r\n              {previewVisible && <><Image\r\n                // width={200}\r\n                preview={false}\r\n                src={previewImage}\r\n              />\r\n              </>\r\n              }\r\n              {!previewVisible && <>\r\n                <p className=\"ant-upload-drag-icon\">\r\n                  <InboxOutlined />\r\n                </p>\r\n                <p className=\"ant-upload-text\">\r\n                  คลิก หรือ ลากไฟล์มาที่บริเวณนี้เพื่ออัปโหลด\r\n                </p>\r\n              </>\r\n              }\r\n            </Dragger>\r\n          </Form.Item>\r\n          <Form.Item\r\n            name=\"header_link\"\r\n            label=\"ลิงค์\"\r\n            style={{ float: 'left' }}\r\n            className=\"block text-gray-700 text-sm font-bold mb-2 w-full\"\r\n          // rules={[\r\n          //   {\r\n          //     required: true,\r\n          //     message: 'กรุณากรอกลิงค์ URL',\r\n          //   },\r\n          // ]}\r\n          >\r\n            <Input\r\n              id=\"#\"\r\n              type=\"text\"\r\n              placeholder=\"ลิงค์\"\r\n              className=\"resize-none border rounded-md\"\r\n            />\r\n          </Form.Item>\r\n          <Form.Item\r\n            className=\" text-gray-700 text-sm font-bold mb-2 w-full\"\r\n          >\r\n            <div className=\"lg:inline-flex text-left w-1/2\">\r\n              <Switch\r\n                className=\"swt-btn\"\r\n                checked={active}\r\n                onClick={value => setActive(value ? 1 : 0)}\r\n              />\r\n              <p className=\"mx-2 text-sm\">การแสดงผล</p>\r\n\r\n            </div>\r\n            <div className=\"lg:inline-flex w-full mt-6\">\r\n              <div className=\"text-center lg:text-right w-full lg:w-full\">\r\n                <Button\r\n                  htmlType=\"button\"\r\n                  onClick={onReset}\r\n                  style={{\r\n                    backgroundColor: '#C2CFE0',\r\n                    borderColor: '#C2CFE0',\r\n                    height: 40,\r\n                    width: 110,\r\n                    marginBottom: '0px !important',\r\n                    marginRight: '2px',\r\n                    color: 'white !important',\r\n                  }}\r\n                  // htmlType=\"submit\"\r\n                  className=\"text-center bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full lg:w-1/4\"\r\n                >\r\n                  <Text className=\"text-custom-black \">รีเซ็ท</Text>\r\n                </Button>\r\n                <Button\r\n                  // type=\"primary\"\r\n                  style={{\r\n                    backgroundColor: '#059669',\r\n                    borderColor: '#059669',\r\n                    height: 40,\r\n                    width: 110,\r\n                    marginBottom: '0px !important',\r\n                    color: 'white !important',\r\n                  }}\r\n                  htmlType=\"submit\"\r\n                  className=\"text-center bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full lg:w-1/4\"\r\n                >\r\n                  <Text className=\"text-custom-white \">บันทึก</Text>\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </Form.Item>\r\n        </Form>\r\n        <div style={{ float: 'left', clear: 'both' }} ref={divRef}></div>\r\n      </Modal>\r\n    </>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}